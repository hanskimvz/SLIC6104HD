(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a2d7c13"],{"0e85":function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o}));var i=a("b775");function l(e){return Object(i["a"])({url:"/v1/media/settings",method:"get",params:{query:e}})}function o(e){return Object(i["a"])({url:"/v1/media/update",method:"post",data:e})}},"144d":function(e,t,a){"use strict";a("843d")},"1c2c":function(e,t,a){},"2b9c":function(e,t,a){},4104:function(e,t,a){"use strict";a("797d")},4381:function(e,t,a){"use strict";a("d3b7"),a("caad"),a("2532");var i=a("4360");function l(e,t){var a=t.value,l=i["a"].getters&&i["a"].getters.roles;if(!(a&&a instanceof Array))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");if(a.length>0){var o=a,s=l.some((function(e){return o.includes(e)}));s||e.parentNode&&e.parentNode.removeChild(e)}}var o={inserted:function(e,t){l(e,t)},update:function(e,t){l(e,t)}},s=function(e){e.directive("permission",o)};window.Vue&&(window["permission"]=o,Vue.use(s)),o.install=s;t["a"]=o},"44bb":function(e,t,a){},"55fa":function(e,t,a){"use strict";a("83c6")},"6c87":function(e,t,a){"use strict";a("a053")},"797d":function(e,t,a){},"7db0":function(e,t,a){"use strict";var i=a("23e7"),l=a("b727").find,o=a("44d2"),s=a("ae40"),n="find",r=!0,c=s(n);n in[]&&Array(1)[n]((function(){r=!1})),i({target:"Array",proto:!0,forced:r||!c},{find:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),o(n)},"81d5":function(e,t,a){"use strict";var i=a("7b0b"),l=a("23cb"),o=a("50c4");e.exports=function(e){var t=i(this),a=o(t.length),s=arguments.length,n=l(s>1?arguments[1]:void 0,a),r=s>2?arguments[2]:void 0,c=void 0===r?a:l(r,a);while(c>n)t[n++]=e;return t}},"83c6":function(e,t,a){},"843d":function(e,t,a){},"85f0":function(e,t,a){},9454:function(e,t,a){"use strict";a("1c2c")},a053:function(e,t,a){},abac:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"media-content"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{key:"first",attrs:{name:"first"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-video-camera"}),e._v(" "+e._s(e.$t("route.video_coding")))]),e.pages.first.istab?a("videoCodec"):e._e()],1),a("el-tab-pane",{key:"third",attrs:{name:"third"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-picture-outline"}),e._v(" "+e._s(e.$t("route.image_parameters")))]),e.pages.third.istab?a("videoCapture"):e._e()],1),a("el-tab-pane",{key:"fifth",attrs:{name:"fifth"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-full-screen"}),e._v(" "+e._s(e.$t("route.osd_settings")))]),e.pages.fifth.istab?a("osd"):e._e()],1),a("el-tab-pane",{key:"seventh",attrs:{name:"seventh"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-view"}),e._v(" "+e._s(e.$t("route.privacy_mask")))]),e.pages.seventh.istab?a("privacyMask"):e._e()],1),a("el-tab-pane",{key:"sixth",attrs:{name:"sixth"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-sunny"}),e._v(" "+e._s(e.$t("route.fill_light")))]),e.pages.sixth.istab?a("filllight"):e._e()],1)],1)],1)],1)},l=[],o=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-card customer_boxhead"},[a("el-form",{ref:"video_codec",staticClass:"custom_form2 auto_wh",attrs:{model:e.video_codec,"label-width":"auto"}},[a("el-col",{attrs:{md:24}},[a("div",{staticClass:"cform-title",attrs:{lg:24}},[a("span",[e._v(e._s(e.$t("video_codec.first_main_stream")))])]),a("el-col",{attrs:{md:{span:14,offset:6}}},[a("el-form-item",{attrs:{label:e.$t("video_codec.encode_format")}},[a("el-select",{model:{value:e.video_codec.main_stream.encode_format,callback:function(t){e.$set(e.video_codec.main_stream,"encode_format",t)},expression:"video_codec.main_stream.encode_format"}},e._l(e.encode_formats,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_codec.resolve")}},[a("el-select",{model:{value:e.video_codec.main_stream.resolve,callback:function(t){e.$set(e.video_codec.main_stream,"resolve",t)},expression:"video_codec.main_stream.resolve"}},e._l(e.ms_resolve_options,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_codec.bitrate")}},[a("el-select",{model:{value:e.video_codec.main_stream.bitrate,callback:function(t){e.$set(e.video_codec.main_stream,"bitrate",t)},expression:"video_codec.main_stream.bitrate"}},e._l(e.bit_rates,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_codec.framerate")}},[a("el-input-number",{attrs:{min:5,max:30},model:{value:e.video_codec.main_stream.framerate,callback:function(t){e.$set(e.video_codec.main_stream,"framerate",t)},expression:"video_codec.main_stream.framerate"}})],1),a("el-form-item",{attrs:{label:e.$t("video_codec.bps")}},[a("el-input-number",{attrs:{min:256,max:8e3},model:{value:e.video_codec.main_stream.bps,callback:function(t){e.$set(e.video_codec.main_stream,"bps",t)},expression:"video_codec.main_stream.bps"}})],1),a("el-form-item",{attrs:{label:e.$t("video_codec.keyframe_interval")}},[a("el-input-number",{attrs:{min:5,max:300},model:{value:e.video_codec.main_stream.keyframe_interval,callback:function(t){e.$set(e.video_codec.main_stream,"keyframe_interval",t)},expression:"video_codec.main_stream.keyframe_interval"}})],1)],1),a("div",{staticClass:"cform-title",attrs:{lg:24}},[a("span",[e._v(e._s(e.$t("video_codec.first_sub_stream")))])]),a("el-col",{attrs:{md:{span:14,offset:6}}},[a("el-form-item",{attrs:{label:e.$t("video_codec.encode_format")}},[a("el-select",{model:{value:e.video_codec.sub_stream.encode_format,callback:function(t){e.$set(e.video_codec.sub_stream,"encode_format",t)},expression:"video_codec.sub_stream.encode_format"}},e._l(e.encode_formats,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_codec.resolve")}},[a("el-select",{model:{value:e.video_codec.sub_stream.resolve,callback:function(t){e.$set(e.video_codec.sub_stream,"resolve",t)},expression:"video_codec.sub_stream.resolve"}},e._l(e.ss_resolve_options,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_codec.bitrate")}},[a("el-select",{model:{value:e.video_codec.sub_stream.bitrate,callback:function(t){e.$set(e.video_codec.sub_stream,"bitrate",t)},expression:"video_codec.sub_stream.bitrate"}},e._l(e.bit_rates,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_codec.framerate")}},[a("el-input-number",{attrs:{min:5,max:30},model:{value:e.video_codec.sub_stream.framerate,callback:function(t){e.$set(e.video_codec.sub_stream,"framerate",t)},expression:"video_codec.sub_stream.framerate"}})],1),a("el-form-item",{attrs:{label:e.$t("video_codec.bps")}},[a("el-input-number",{attrs:{min:64,max:1e3},model:{value:e.video_codec.sub_stream.bps,callback:function(t){e.$set(e.video_codec.sub_stream,"bps",t)},expression:"video_codec.sub_stream.bps"}})],1),a("el-form-item",{attrs:{label:e.$t("video_codec.keyframe_interval")}},[a("el-input-number",{attrs:{min:5,max:300},model:{value:e.video_codec.sub_stream.keyframe_interval,callback:function(t){e.$set(e.video_codec.sub_stream,"keyframe_interval",t)},expression:"video_codec.sub_stream.keyframe_interval"}})],1),e.checkPermission(["admin","operator"])?a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("button.save")))]),a("el-button",{on:{click:e.onRefresh}},[e._v(e._s(e.$t("button.refresh")))]),a("el-button",{attrs:{type:"warning"},on:{click:e.onDefault}},[e._v(e._s(e.$t("button.default")))])],1):e._e()],1)],1)],1)],1)}),s=[],n=(a("b64b"),a("e9c4"),a("99af"),a("e350")),r=a("0e85"),c=a("61f7"),d={data:function(){return{video_codec:{main_stream:{encode_format:0,resolve:null,resolve_enum:[],bitrate:null,framerate:0,bps:0,keyframe_interval:0},sub_stream:{encode_format:0,resolve:null,resolve_enum:[],bitrate:null,framerate:0,bps:0,keyframe_interval:0}},prev_data:null,encode_formats:[{label:"video_codec.h264",value:2},{label:"video_codec.h265",value:3}],ms_resolve_options:[],ss_resolve_options:[],bit_rates:[{label:"CBR",value:0},{label:"VBR",value:1}]}},created:function(){this.fetchData()},methods:{checkPermission:n["a"],fetchData:function(){var e=this;Object(r["a"])("video_codec").then((function(t){e.video_codec=t.data.settings,e.prev_data=JSON.parse(JSON.stringify(e.video_codec)),window.console.log(e.video_codec),e.updateUi()}))},updateData:function(){var e=this;Object(r["b"])({type:"video_codec",settings:this.video_codec}).then((function(t){window.console.log("已经设置编码 %o",e.video_codec),window.console.log("以前编码 %o",e.prev_data),e.isNeedRestart()&&Object(c["a"])(15)}))},isNeedRestart:function(){return this.video_codec.main_stream.encode_format!==this.prev_data.main_stream.encode_format||this.video_codec.main_stream.resolve!==this.prev_data.main_stream.resolve||this.video_codec.sub_stream.encode_format!==this.prev_data.sub_stream.encode_format||this.video_codec.sub_stream.resolve!==this.prev_data.sub_stream.resolve},updateUi:function(){this.ms_resolve_options=this.valuesToOptions(this.video_codec.main_stream.resolve_enum),this.ss_resolve_options=this.valuesToOptions(this.video_codec.sub_stream.resolve_enum),sessionStorage.setItem("main_stream_video_codec",3===this.video_codec.main_stream.encode_format?"h265":"h264"),sessionStorage.setItem("sub_stream_video_codec",3===this.video_codec.sub_stream.encode_format?"h265":"h264")},valuesToOptions:function(e){for(var t=[],a=0;a<e.length;a++){var i=e[a],l=Math.floor(i/1e4),o=Math.floor(i%1e4),s={label:"".concat(l," × ").concat(o),value:i};t.push(s)}return t},onSubmit:function(){this.updateData()},onRefresh:function(){this.fetchData(),window.console.log("reload!")},onDefault:function(){var e=this;Object(r["a"])("video_codec_default").then((function(t){e.video_codec=t.data.settings,window.console.log(e.video_codec),e.updateUi()}))}}},u=d,m=(a("b2f1"),a("2877")),_=Object(m["a"])(u,o,s,!1,null,"31b9f0c9",null),f=_.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"media-content"},[a("el-col",{attrs:{xl:18,lg:17,md:15,xs:24,sm:24}},[a("div",{staticClass:"media-img customer_vbox",staticStyle:{height:"600px",overflow:"hidden"}},[a("iframe",{attrs:{id:"wx-player",width:"100%",height:"100%",src:e.html_path,frameborder:"no"}})])]),a("el-col",{attrs:{xl:6,lg:7,md:9,xs:24,sm:24}},[a("el-form",{ref:"video_capture",staticClass:"custom_form2 auto_wh",attrs:{model:e.video_capture,size:"small"}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:e.$t("video_capture.capture_setting")}},[a("el-form-item",{staticClass:"no_label_lh",attrs:{label:e.$t("video_capture.brightness")}},[a("el-slider",{model:{value:e.video_capture.brightness,callback:function(t){e.$set(e.video_capture,"brightness",t)},expression:"video_capture.brightness"}})],1),a("el-form-item",{staticClass:"no_label_lh",attrs:{label:e.$t("video_capture.contrast")}},[a("el-slider",{model:{value:e.video_capture.contrast,callback:function(t){e.$set(e.video_capture,"contrast",t)},expression:"video_capture.contrast"}})],1),a("el-form-item",{staticClass:"no_label_lh",attrs:{label:e.$t("video_capture.saturation")}},[a("el-slider",{model:{value:e.video_capture.saturation,callback:function(t){e.$set(e.video_capture,"saturation",t)},expression:"video_capture.saturation"}})],1),a("el-form-item",{staticClass:"no_label_lh",attrs:{label:e.$t("video_capture.backlight")}},[a("el-slider",{model:{value:e.video_capture.backlight,callback:function(t){e.$set(e.video_capture,"backlight",t)},expression:"video_capture.backlight"}})],1),a("el-form-item",{staticClass:"no_label_lh",attrs:{label:e.$t("video_capture.sharpness")}},[a("el-slider",{model:{value:e.video_capture.sharpness,callback:function(t){e.$set(e.video_capture,"sharpness",t)},expression:"video_capture.sharpness"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.video_standard")}},[a("el-select",{model:{value:e.video_capture.video_standard,callback:function(t){e.$set(e.video_capture,"video_standard",t)},expression:"video_capture.video_standard"}},e._l(e.video_standards,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_capture.horizontal_flip")}},[a("el-switch",{model:{value:e.video_capture.horizontal_flip,callback:function(t){e.$set(e.video_capture,"horizontal_flip",t)},expression:"video_capture.horizontal_flip"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.vertical_flip")}},[a("el-switch",{model:{value:e.video_capture.vertical_flip,callback:function(t){e.$set(e.video_capture,"vertical_flip",t)},expression:"video_capture.vertical_flip"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.prevent_overexposure")}},[a("el-switch",{model:{value:e.video_capture.prevent_overexposure,callback:function(t){e.$set(e.video_capture,"prevent_overexposure",t)},expression:"video_capture.prevent_overexposure"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.scene_mode")}},[a("el-select",{model:{value:e.video_capture.scene_mode,callback:function(t){e.$set(e.video_capture,"scene_mode",t)},expression:"video_capture.scene_mode"}},e._l(e.scene_modes,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1)],1),a("el-tab-pane",{attrs:{label:e.$t("video_capture.advance_setting")}},[a("el-form-item",{attrs:{label:e.$t("video_capture.AE_sensitivity")}},[a("el-slider",{staticClass:"no_label_lh",attrs:{max:255},model:{value:e.video_capture.AE_sensitivity,callback:function(t){e.$set(e.video_capture,"AE_sensitivity",t)},expression:"video_capture.AE_sensitivity"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.AE_tolerance")}},[a("el-slider",{staticClass:"no_label_lh",attrs:{max:255},model:{value:e.video_capture.AE_tolerance,callback:function(t){e.$set(e.video_capture,"AE_tolerance",t)},expression:"video_capture.AE_tolerance"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.exposure_mode")}},[a("el-select",{model:{value:e.video_capture.exposure_mode,callback:function(t){e.$set(e.video_capture,"exposure_mode",t)},expression:"video_capture.exposure_mode"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.white_balance")}},[a("el-select",{model:{value:e.video_capture.white_balance,callback:function(t){e.$set(e.video_capture,"white_balance",t)},expression:"video_capture.white_balance"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.wide_dynamic")}},[a("el-select",{model:{value:e.video_capture.wide_dynamic,callback:function(t){e.$set(e.video_capture,"wide_dynamic",t)},expression:"video_capture.wide_dynamic"}},e._l(e.wide_dynamics,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_capture.wide_dynamic_enhancement")}},[a("el-slider",{staticClass:"no_label_lh",attrs:{disabled:2!==e.video_capture.wide_dynamic,max:255},model:{value:e.video_capture.wide_dynamic_enhancement,callback:function(t){e.$set(e.video_capture,"wide_dynamic_enhancement",t)},expression:"video_capture.wide_dynamic_enhancement"}})],1),a("el-form-item",{attrs:{label:e.$t("video_capture.noise_reduction_3d")}},[a("el-select",{model:{value:e.video_capture.noise_reduction_3d,callback:function(t){e.$set(e.video_capture,"noise_reduction_3d",t)},expression:"video_capture.noise_reduction_3d"}},e._l(e.noise_reductions,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("video_capture.noise_reduction_3d_enhancement")}},[a("el-slider",{staticClass:"no_label_lh",attrs:{disabled:2!==e.video_capture.noise_reduction_3d,max:255},model:{value:e.video_capture.noise_reduction_3d_enhancement,callback:function(t){e.$set(e.video_capture,"noise_reduction_3d_enhancement",t)},expression:"video_capture.noise_reduction_3d_enhancement"}})],1)],1),a("div",{directives:[{name:"permission",rawName:"v-permission",value:["admin","operator"],expression:"['admin', 'operator']"}],staticClass:"mt20 ",attrs:{align:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("button.save")))]),a("el-button",{on:{click:e.onRefresh}},[e._v(e._s(e.$t("button.refresh")))]),a("el-button",{attrs:{type:"warning"},on:{click:e.onDefault}},[e._v(e._s(e.$t("button.default")))])],1)],1)],1)],1)],1)},h=[],b=a("4381"),p={components:{},directives:{permission:b["a"]},data:function(){return{html_path:"/static/player/index.html",video_capture:{brightness:0,contrast:0,saturation:0,backlight:0,sharpness:0,video_standard:0,horizontal_flip:!1,vertical_flip:!1,prevent_overexposure:!1,scene_mode:0,AE_sensitivity:0,AE_tolerance:0,exposure_mode:0,white_balance:0,wide_dynamic:0,wide_dynamic_enhancement:0,noise_reduction_3d:0,noise_reduction_3d_enhancement:0},video_standards:[{label:"PAL",value:0},{label:"NTSC",value:1}],scene_modes:[{label:"video_capture.auto",value:0},{label:"video_capture.indoor",value:1},{label:"video_capture.outdoor",value:2}],wide_dynamics:[{label:"video_capture.disable",value:0},{label:"video_capture.auto",value:1},{label:"video_capture.manual",value:2}],noise_reductions:[{label:"video_capture.disable",value:0},{label:"video_capture.auto",value:1},{label:"video_capture.manual",value:2}]}},created:function(){this.fetchData()},mounted:function(){this.loadPlayer()},methods:{loadPlayer:function(){var e=document.getElementById("wx-player");e.onload=function(){var t=e.contentWindow;t.postMessage({id:16,stream:1},"*")}},fetchData:function(){var e=this;Object(r["a"])("video_capture").then((function(t){e.video_capture=t.data.settings,window.console.log(e.video_capture)}))},updateData:function(){Object(r["b"])({type:"video_capture",settings:this.video_capture}).then((function(e){window.console.log("updated!")}))},onSubmit:function(){this.updateData()},onRefresh:function(){this.fetchData(),window.console.log("reload!")},onDefault:function(){var e=this;Object(r["a"])("video_capture_default").then((function(t){e.video_capture=t.data.settings,window.console.log(e.video_capture)}))}}},g=p,y=(a("fbdf"),Object(m["a"])(g,v,h,!1,null,"7a75afae",null)),w=y.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"media-content"},[a("el-col",{attrs:{xl:18,lg:17,md:15,xs:24,sm:24}},[a("div",{staticClass:"media-img customer_vbox",staticStyle:{height:"600px",overflow:"hidden"}},[a("iframe",{attrs:{id:"wx-player",width:"100%",height:"100%",src:e.html_path,frameborder:"no"}}),a("div",{ref:"cavbox",attrs:{id:"osd_canvastext"}},[a("Canvastext",{attrs:{layers:e.datetime_title},on:{"update:layers":function(t){e.datetime_title=t}}})],1)])]),a("el-col",{attrs:{xl:6,lg:7,md:9,xs:24,sm:24}},[a("el-form",{ref:"datetime_title",staticClass:"custom_form2 auto_wh",attrs:{model:e.datetime_title,size:"small"}},[a("el-collapse",{staticClass:"custom_collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:e.$t("button.setting"),name:"1"}},[a("el-form-item",{attrs:{label:e.$t("osd.use_title")}},[a("el-switch",{model:{value:e.datetime_title.title.enabled,callback:function(t){e.$set(e.datetime_title.title,"enabled",t)},expression:"datetime_title.title.enabled"}})],1),a("el-form-item",{staticClass:"customeritem-label",attrs:{label:e.$t("datetime_title.x")}},[a("el-input-number",{attrs:{precision:2,step:.1,max:100,disabled:!e.datetime_title.title.enabled},model:{value:e.datetime_title.title.x,callback:function(t){e.$set(e.datetime_title.title,"x",t)},expression:"datetime_title.title.x"}})],1),a("el-form-item",{staticClass:"customeritem-label",attrs:{label:e.$t("datetime_title.y")}},[a("el-input-number",{attrs:{precision:2,step:.1,max:100,disabled:!e.datetime_title.title.enabled},model:{value:e.datetime_title.title.y,callback:function(t){e.$set(e.datetime_title.title,"y",t)},expression:"datetime_title.title.y"}})],1),a("el-form-item",{attrs:{label:e.$t("datetime_title.name")}},[a("el-input",{staticClass:"w200",attrs:{disabled:!e.datetime_title.title.enabled,maxlength:"32"},model:{value:e.datetime_title.title.name,callback:function(t){e.$set(e.datetime_title.title,"name",t)},expression:"datetime_title.title.name"}})],1),a("el-divider"),a("el-form-item",{attrs:{label:e.$t("datetime_title.datetime")}},[a("el-switch",{model:{value:e.datetime_title.datetime.enabled,callback:function(t){e.$set(e.datetime_title.datetime,"enabled",t)},expression:"datetime_title.datetime.enabled"}})],1),a("el-form-item",{staticClass:"customeritem-label2",attrs:{label:e.$t("datetime_title.x")}},[a("el-input-number",{attrs:{precision:2,step:.1,max:100,disabled:!e.datetime_title.datetime.enabled},model:{value:e.datetime_title.datetime.x,callback:function(t){e.$set(e.datetime_title.datetime,"x",t)},expression:"datetime_title.datetime.x"}})],1),a("el-form-item",{staticClass:"customeritem-label2",attrs:{label:e.$t("datetime_title.y")}},[a("el-input-number",{attrs:{precision:2,step:.1,max:100,disabled:!e.datetime_title.datetime.enabled},model:{value:e.datetime_title.datetime.y,callback:function(t){e.$set(e.datetime_title.datetime,"y",t)},expression:"datetime_title.datetime.y"}})],1),a("el-form-item",{attrs:{label:e.$t("datetime_title.time_format")}},[a("el-select",{attrs:{disabled:!e.datetime_title.datetime.enabled},model:{value:e.datetime_title.datetime.time_format,callback:function(t){e.$set(e.datetime_title.datetime,"time_format",t)},expression:"datetime_title.datetime.time_format"}},e._l(e.time_formats,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("datetime_title.date_format")}},[a("el-select",{attrs:{disabled:!e.datetime_title.datetime.enabled},model:{value:e.datetime_title.datetime.date_format,callback:function(t){e.$set(e.datetime_title.datetime,"date_format",t)},expression:"datetime_title.datetime.date_format"}},e._l(e.date_formats,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("datetime_title.week")}},[a("el-switch",{model:{value:e.datetime_title.datetime.week,callback:function(t){e.$set(e.datetime_title.datetime,"week",t)},expression:"datetime_title.datetime.week"}})],1),a("el-form-item",{attrs:{label:e.$t("datetime_title.style")}},[a("el-select",{attrs:{disabled:!e.datetime_title.datetime.enabled},model:{value:e.datetime_title.datetime.style,callback:function(t){e.$set(e.datetime_title.datetime,"style",t)},expression:"datetime_title.datetime.style"}},e._l(e.week_style,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("div",{directives:[{name:"permission",rawName:"v-permission",value:["admin","operator"],expression:"['admin', 'operator']"}],staticClass:"mt20 ",attrs:{align:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("button.save")))]),a("el-button",{on:{click:e.onRefresh}},[e._v(e._s(e.$t("button.refresh")))]),a("el-button",{attrs:{type:"warning"},on:{click:e.onDefault}},[e._v(e._s(e.$t("button.default")))])],1)],1)],1)],1)],1)],1)},k=[],$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("canvas",{ref:"markCanvas",attrs:{id:"canvastext"}})},D=[],C=(a("cb29"),a("d3b7"),a("159b"),a("a434"),a("b680"),{props:["layers","cavbox"],data:function(){return{markList:this.layers,canvasbox:this.cavbox}},watch:{layers:{handler:function(e,t){console.log("son change"),this.initCanvas()},deep:!0}},mounted:function(){document.getElementById("canvastext");this.initCanvas()},methods:{initCanvas:function(){var e=this,t=this;this.$nextTick((function(){var a=e.$refs.markCanvas;a.width=a.clientWidth,a.height=a.clientHeight;var i=a.getContext("2d");a.style.cursor="crosshair";var l=e.layers;i.font="16px Arial";var o=[];if(i.clearRect(0,0,a.width,a.height),l.datetime.enabled){var s=t.gettime(l.datetime.time_format,l.datetime.date_format),n=Math.floor(i.measureText(s).width)+30,r={x:l.datetime.x*a.width/100,y:l.datetime.y*a.height/100,w:n,h:30,text:s,id:"time",size:"16px",op:100,c:"red"};o.push(r)}if(l.title.enabled){var c=Math.floor(i.measureText(l.title.name).width)+30,d={x:l.title.x*a.width/100,y:l.title.y*a.height/100,w:c,h:30,text:l.title.name,id:"title",size:"16px",op:100,c:"red"};o.push(d)}if(0!==o.length){i.strokeStyle="RGBA(102,102,102,0.9)",i.lineWidth=1;for(var u=0;u<o.length;u++)i.beginPath(),i.rect(o[u].x,o[u].y,o[u].w,o[u].h),i.fillStyle="RGBA(255,255,255,0.9)",i.fill(),i.stroke(),t.addtext(i,o[u])}t.reDraw(a,i,o,null),t.draw(a,o)}))},draw:function(e,t,a){var i=e.getContext("2d");i.lineWidth=2;var l=0,o=0,s=this;e.onmousemove=function(n){var r;if(l=n.offsetX,o=n.offsetY,0===t.length);else if(void 0===a)t.forEach((function(a,n,c){a.w>0&&a.h>0&&l>a.x&&l<a.x+a.w&&o>a.y&&o<a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),a.w<0&&a.h>0&&l<a.x&&l>a.x+a.w&&o>a.y&&o<a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),a.w>0&&a.h<0&&l>a.x&&l<a.x+a.w&&o<a.y&&o>a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),a.w<0&&a.h<0&&l<a.x&&l>a.x+a.w&&o<a.y&&o>a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),void 0===r&&(e.onmousedown=function(e){return!1})}));else for(var c=0;c<t.length;c++){var d=t[c];if(d.w>0&&d.h>0&&l>d.x&&l<d.x+d.w&&o>d.y&&o<d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}if(d.w<0&&d.h>0&&l<d.x&&l>d.x+d.w&&o>d.y&&o<d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}if(d.w>0&&d.h<0&&l>d.x&&l<d.x+d.w&&o<d.y&&o>d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}if(d.w<0&&d.h<0&&l<d.x&&l>d.x+d.w&&o<d.y&&o>d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}e.onmousedown=function(e){return!1}}e.onmouseout=function(i){void 0!==a&&s.draw(e,t,a)}}},judgeDraw:function(e,t,a,i){var l=this;e.style.cursor="default";var o=0,s=0;e.onmousedown=function(n){o=n.offsetX,s=n.offsetY,l.reDraw(e,t,a,i),e.onmouseup=function(){l.reDraw(e,t,a,i),l.draw(e,a,i)},l.moveDraw(e,t,a,i,o,s),l.delDraw(e,t,a,i)}},moveDraw:function(e,t,a,i,l,o){var s=this,n=a[i];e.onmousemove=function(r){var c={x:n.x+(r.offsetX-l),y:n.y+(r.offsetY-o),w:n.w,h:n.h,text:n.text,id:n.id,size:n.size,op:n.op,c:n.c};a.splice(i,1,c),s.delDraw(e,t,a,i),s.reDraw(e,t,a,i)},e.onmouseup=function(){s.reDraw(e,t,a,i),s.draw(e,a,i),s.changelist(e,a)}},delDraw:function(e,t,a,i){var l=this;e.onkeydown=null===i?function(e){return!1}:function(o){var s=o.keyCode||o.which;8==s&&null!==i&&(a.length>=1?(a.splice(i,1),l.reDraw(e,t,a)):t.clearRect(0,0,e.width,e.height),l.delDraw(e,t,a,null),l.reDraw(e,t,a),l.draw(e,a))}},reDraw:function(e,t,a,i){var l=this;t.clearRect(0,0,e.width,e.height),a.forEach((function(e,a,o){void 0!==i&&a==i||(t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.fillStyle="RGBA(255,255,255,0.9)",t.fill(),t.stroke(),l.addtext(t,e))})),a.forEach((function(e,a,o){a===i&&(t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.fillStyle="RGBA(255,255,255,0.9)",t.fill(),t.stroke(),l.addtext(t,e))}))},addtext:function(e,t){e.font=t.size+" Arial",e.textAlign="center",e.textBaseline="middle",e.fillStyle=t.c,e.globalAlpha=t.op/100,e.fillText(t.text,t.x+t.w/2,t.y+t.h/2),e.stroke()},changelist:function(e,t){if(t.length>0)for(var a=0;a<t.length;a++)"custom"==t[a].id?(this.$set(this.layers.custom_settings,"x",(t[a].x/e.width*100).toFixed(2)),this.$set(this.layers.custom_settings,"y",(t[a].y/e.height*100).toFixed(2))):"time"==t[a].id?(this.$set(this.layers.datetime,"x",(t[a].x/e.width*100).toFixed(2)),this.$set(this.layers.datetime,"y",(t[a].y/e.height*100).toFixed(2))):"title"==t[a].id&&(this.$set(this.layers.title,"x",(t[a].x/e.width*100).toFixed(2)),this.$set(this.layers.title,"y",(t[a].y/e.height*100).toFixed(2)));this.$emit("update:layers",this.layers)},gettime:function(e,t){var a;a=[this.$t("time.weekday"),this.$t("time.monday"),this.$t("time.tuesday"),this.$t("time.wednesday"),this.$t("time.thursday"),this.$t("time.friday"),this.$t("time.saturday")];var i=new Date,l=i.getFullYear(),o=i.getMonth()+1,s=i.getDate(),n=i.getHours(),r=i.getMinutes(),c=i.getSeconds(),d=i.getDay();e&&0==e&&(n<=12?n=this.$t("time.am")+" "+n:n>12&&n<24?(n-=12,n=this.$t("time.pm")+" "+this.fillZero(n)):24==n&&(n=this.$t("time.pm")+" 00"));var u=l+"/"+o+"/"+s+"/\t"+n+":"+r+":"+c+"\t"+a[d];return u},fillZero:function(e){return e<10&&(e="0"+e),e}}}),Y=C,O=(a("9454"),Object(m["a"])(Y,$,D,!1,null,"7ab485f4",null)),j=O.exports,M={components:{Canvastext:j},directives:{permission:b["a"]},data:function(){return{value1:30,activeNames:["1"],html_path:"/static/player/index.html",datetime_title:{datetime:{enabled:null,x:null,y:null,time_format:0,week:null,date_format:1,style:0},title:{channel:0,enabled:null,x:null,y:null,name:null,color:0}},colors:[{label:"colors.white",value:"#fff"},{label:"colors.black",value:"#000"},{label:"colors.grey",value:"#9E9E9E"},{label:"colors.yellow",value:"#FFA000"},{label:"colors.green",value:"#4CAF50"},{label:"colors.red",value:"#FF5252"}],time_formats:[{label:"datetime_title.hour24",value:0},{label:"datetime_title.hour12",value:1}],week_style:[{label:"datetime_title.english",value:0},{label:"datetime_title.chinese",value:1}],date_formats:[{label:"YYYY-MM-DD (1990-10-15)",value:0},{label:"MM-DD-YYYY (10-15-1990)",value:1},{label:"DD-MM-YYYY (15-10-1990)",value:2},{label:"YYYY/MM/DD (1990/10/15)",value:3},{label:"MM/DD/YYYY (10/15/1990)",value:4},{label:"DD/MM/YYYY (15/10/1990)",value:5}]}},computed:{},watch:{datetime_title:{handler:function(e,t){},deep:!0}},created:function(){this.fetchData()},mounted:function(){this.loadPlayer();var e=document.getElementById("wx-player");this.iframeWin=e.contentWindow},methods:{sendMessage:function(e){this.iframeWin.postMessage({layers:e,index:this.current_select,delete:this.current_select},"*")},loadPlayer:function(){var e=this,t=document.getElementById("wx-player");t.onload=function(){var a=t.contentWindow;a.postMessage({id:16,stream:1,layers:e.postCanvasArr},"*")}},fetchData:function(){var e=this;Object(r["a"])("datetime_title").then((function(t){e.datetime_title=t.data.settings,window.console.log(e.datetime_title)}))},updateData:function(){Object(r["b"])({type:"datetime_title",settings:this.datetime_title}).then((function(e){window.console.log("updated!")}))},onSubmit:function(){this.updateData()},onRefresh:function(){this.fetchData(),window.console.log("reload!")},onDefault:function(){var e=this;Object(r["a"])("datetime_title_default").then((function(t){e.datetime_title=t.data.settings,window.console.log(e.datetime_title)}))}}},S=M,z=(a("55fa"),Object(m["a"])(S,x,k,!1,null,"a87d8914",null)),A=z.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-card customer_boxhead"},[a("el-col",{attrs:{xl:18,lg:17,md:15,xs:24,sm:24}},[a("div",{staticClass:"media-img customer_vbox",staticStyle:{height:"600px",overflow:"hidden"}},[a("iframe",{attrs:{id:"wx-player",width:"100%",height:"100%",src:e.html_path,frameborder:"no"}}),a("div",{ref:"cavbox",attrs:{id:"osd_canvastext"}},[a("Canvasrect",{attrs:{layers:e.privacy_mask,current_id:e.current_select},on:{"update:layers":function(t){e.privacy_mask=t},"update:current_id":function(t){e.current_select=t}}})],1)])]),a("el-col",{attrs:{xl:6,lg:7,md:9,xs:24,sm:24}},[a("el-form",{ref:"privacy_mask",staticClass:"custom_form2 auto_wh",attrs:{model:e.privacy_mask,"label-width":"auto"}},[a("el-collapse",{staticClass:"custom_collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:e.$t("button.setting"),name:"1"}},[a("el-form-item",{attrs:{label:e.$t("privacy_mask.privacy_zone")}},[a("el-select",{attrs:{size:"small"},model:{value:e.current_select,callback:function(t){e.current_select=t},expression:"current_select"}},[a("el-option",{attrs:{label:"1",value:"1"}}),a("el-option",{attrs:{label:"2",value:"2"}}),a("el-option",{attrs:{label:"3",value:"3"}}),a("el-option",{attrs:{label:"4",value:"4"}})],1)],1),a("el-form-item",{attrs:{label:e.$t("privacy_mask.enabled")}},[a("el-switch",{model:{value:e.privacy_mask.privacy_zone[e.current_select-1].enabled,callback:function(t){e.$set(e.privacy_mask.privacy_zone[e.current_select-1],"enabled",t)},expression:"privacy_mask.privacy_zone[current_select - 1].enabled"}})],1),a("el-form-item",{attrs:{label:e.$t("privacy_mask.x")}},[a("el-input-number",{attrs:{min:0,max:100},model:{value:e.privacy_mask.privacy_zone[e.current_select-1].x,callback:function(t){e.$set(e.privacy_mask.privacy_zone[e.current_select-1],"x",t)},expression:"privacy_mask.privacy_zone[current_select - 1].x"}})],1),a("el-form-item",{attrs:{label:e.$t("privacy_mask.y")}},[a("el-input-number",{attrs:{min:0,max:100},model:{value:e.privacy_mask.privacy_zone[e.current_select-1].y,callback:function(t){e.$set(e.privacy_mask.privacy_zone[e.current_select-1],"y",t)},expression:"privacy_mask.privacy_zone[current_select - 1].y"}})],1),a("el-form-item",{attrs:{label:e.$t("privacy_mask.width")}},[a("el-input-number",{attrs:{min:0,max:100},model:{value:e.privacy_mask.privacy_zone[e.current_select-1].width,callback:function(t){e.$set(e.privacy_mask.privacy_zone[e.current_select-1],"width",t)},expression:"privacy_mask.privacy_zone[current_select - 1].width"}})],1),a("el-form-item",{attrs:{label:e.$t("privacy_mask.height")}},[a("el-input-number",{attrs:{min:0,max:100},model:{value:e.privacy_mask.privacy_zone[e.current_select-1].height,callback:function(t){e.$set(e.privacy_mask.privacy_zone[e.current_select-1],"height",t)},expression:"privacy_mask.privacy_zone[current_select - 1].height"}})],1),a("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:["admin","operator"],expression:"['admin', 'operator']"}],staticClass:"mt20",attrs:{align:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("button.save")))]),a("el-button",{attrs:{type:"danger"},on:{click:e.deletelayer}},[e._v(e._s(e.$t("button.delete")))]),a("el-button",{on:{click:e.onRefresh}},[e._v(e._s(e.$t("button.refresh")))]),a("el-button",{attrs:{type:"warning"},on:{click:e.onDefault}},[e._v(e._s(e.$t("button.default")))])],1)],1)],1)],1)],1)],1)},N=[],X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("canvas",{ref:"rectCanvas",attrs:{id:"canvasrect"}})},P=[],R={props:["layers","cavbox","current_id"],data:function(){return{markList:this.layers,canvasbox:this.cavbox}},watch:{layers:{handler:function(e,t){console.log("son change"),this.initCanvas()},deep:!0}},mounted:function(){this.initCanvas()},methods:{initCanvas:function(){var e=this,t=this;this.$nextTick((function(){var a=e.$refs.rectCanvas;a.width=a.clientWidth,a.height=a.clientHeight;var i=a.getContext("2d");a.style.cursor="crosshair";var l=e.layers.privacy_zone,o=[];i.clearRect(0,0,a.width,a.height);for(var s=0;s<l.length;s++){var n={};n={x:e.toDecimal(l[s].x*a.width/100),y:e.toDecimal(l[s].y*a.height/100),w:e.toDecimal(l[s].width*a.width/100),h:e.toDecimal(l[s].height*a.height/100),enabled:l[s].enabled,color:l[s].color,label:s},o.push(n)}for(var r=0;r<o.length;r++)o[r].enabled&&(i.beginPath(),i.strokeStyle="red",i.rect(o[r].x,o[r].y,o[r].width,o[r].height),i.fillStyle="#f5f5f5",i.fill(),i.stroke());console.log(o),t.reDraw(a,i,o,null),t.draw(a,o)}))},draw:function(e,t,a){var i=e.getContext("2d");i.strokeStyle="blue",i.lineWidth=2;var l=0,o=0,s=this;e.onmousemove=function(n){var r;if(l=n.offsetX,o=n.offsetY,0===t.length&&s.newDraw(e,i,t),void 0===a)t.forEach((function(a,n,c){a.w>0&&a.h>0&&l>a.x&&l<a.x+a.w&&o>a.y&&o<a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),a.w<0&&a.h>0&&l<a.x&&l>a.x+a.w&&o>a.y&&o<a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),a.w>0&&a.h<0&&l>a.x&&l<a.x+a.w&&o<a.y&&o>a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),a.w<0&&a.h<0&&l<a.x&&l>a.x+a.w&&o<a.y&&o>a.y+a.h&&(r=n,s.judgeDraw(e,i,t,r)),void 0===r&&s.newDraw(e,i,t)}));else for(var c=0;c<t.length;c++){var d=t[c];if(l<d.x+5&&l>d.x-5&&o<d.y+5&&o>d.y-5){if(c===a){s.changeDraw(e,i,t,a,1);break}}else if(l<d.x+d.w+5&&l>d.x+d.w-5&&o<d.y+5&&o>d.y-5){if(c===a){s.changeDraw(e,i,t,a,2);break}}else if(l<d.x+5&&l>d.x-5&&o<d.y+d.h+5&&o>d.y+d.h-5){if(c===a){s.changeDraw(e,i,t,a,3);break}}else if(l<d.x+d.w+5&&l>d.x+d.w-5&&o<d.y+d.h+5&&o>d.y+d.h-5){if(c===a){s.changeDraw(e,i,t,a,4);break}}else{if(d.w>0&&d.h>0&&l>d.x&&l<d.x+d.w&&o>d.y&&o<d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}if(d.w<0&&d.h>0&&l<d.x&&l>d.x+d.w&&o>d.y&&o<d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}if(d.w>0&&d.h<0&&l>d.x&&l<d.x+d.w&&o<d.y&&o>d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}if(d.w<0&&d.h<0&&l<d.x&&l>d.x+d.w&&o<d.y&&o>d.y+d.h){r=c,s.judgeDraw(e,i,t,c);break}void 0===r&&s.newDraw(e,i,t)}}e.onmouseout=function(i){void 0!==a&&s.draw(e,t,a)}}},changeDraw:function(e,t,a,i,l){e.style.cursor="pointer";var o=a[i],s=this;e.onmousedown=function(n){var r=n.offsetX,c=n.offsetY;e.onmousemove=function(n){var d={};switch(l){case 1:d={x:n.offsetX,y:n.offsetY,w:o.w-(n.offsetX-r),h:o.h-(n.offsetY-c),enabled:o.enabled,label:o.label};break;case 2:d={x:o.x,y:o.y+(n.offsetY-c),w:o.w+(n.offsetX-r),h:o.h-(n.offsetY-c),enabled:o.enabled,label:o.label};break;case 3:d={x:o.x+(n.offsetX-r),y:o.y,w:o.w-(n.offsetX-r),h:o.h+(n.offsetY-c),enabled:o.enabled,label:o.label};break;case 4:d={x:o.x,y:o.y,w:o.w+(n.offsetX-r),h:o.h+(n.offsetY-c),enabled:o.enabled,label:o.label};break}a.splice(i,1,d),s.reDraw(e,t,a,i)},e.onmouseout=function(i){s.reDraw(e,t,a),s.draw(e,a)},s.delDraw(e,t,a,i)}},newDraw:function(e,t,a){e.style.cursor="crosshair";var i=!1,l=0,o=0,s=this,n=this.current_id-1;a[this.current_id-1].enabled&&(e.onmousedown=function(r){i=!0,l=r.offsetX,o=r.offsetY,s.delDraw(e,t,a,null),e.onmousemove=function(n){i&&(s.reDraw(e,t,a),t.beginPath(),t.setLineDash([8,4]),t.rect(l,o,n.offsetX-l,n.offsetY-o),t.stroke())},e.onmouseup=function(r){var c;i&&Math.abs(r.offsetX-l)>10&&Math.abs(r.offsetY-o)>10?(c=r.offsetY-o<0&&r.offsetX-l<0?{x:r.offsetX,y:r.offsetY,w:Math.abs(r.offsetX-l),h:Math.abs(r.offsetY-o),enabled:!0,label:n}:r.offsetY-o>0&&r.offsetX-l<0?{x:r.offsetX,y:o,w:Math.abs(r.offsetX-l),h:Math.abs(r.offsetY-o),enabled:!0,label:n}:r.offsetY-o<0&&r.offsetX-l>0?{x:l,y:r.offsetY,w:Math.abs(r.offsetX-l),h:Math.abs(r.offsetY-o),enabled:!0,label:n}:{x:l,y:o,w:r.offsetX-l,h:r.offsetY-o,enabled:!0,label:n},a.splice(n,1,c),s.reDraw(e,t,a),i=!1,s.draw(e,a)):(s.reDraw(e,t,a),i=!1,s.draw(e,a));s.changelist(e,a)},e.onmouseout=function(r){if(i&&Math.abs(r.offsetX-l)>10&&Math.abs(r.offsetY-o)>10){var c={x:l,y:o,w:r.offsetX-l,h:r.offsetY-o,enabled:!0,label:n};a.splice(n,1,c),s.reDraw(e,t,a),i=!1,s.draw(e,a)}else s.reDraw(e,t,a),i=!1,s.draw(e,a);s.changelist(e,a)}})},judgeDraw:function(e,t,a,i){e.style.cursor="default";var l=0,o=0,s=this;e.onmousedown=function(n){l=n.offsetX,o=n.offsetY,s.reDraw(e,t,a,i),e.onmouseup=function(){s.reDraw(e,t,a,i),s.draw(e,a,i)},s.moveDraw(e,t,a,i,l,o),s.delDraw(e,t,a,i),(i||0==i)&&(s.$emit("update:current_id",i+1),s.changelist(e,a))}},moveDraw:function(e,t,a,i,l,o){var s=this,n=a[i];e.onmousemove=function(r){var c={x:n.x+(r.offsetX-l),y:n.y+(r.offsetY-o),w:n.w,h:n.h,enabled:n.enabled,label:n.label};a.splice(i,1,c),s.delDraw(e,t,a,i),s.reDraw(e,t,a,i)},e.onmouseup=function(){s.reDraw(e,t,a,i),s.draw(e,a,i),s.changelist(e,a)}},delDraw:function(e,t,a,i){var l=this;e.onkeydown=null===i?function(e){return!1}:function(o){var s=o.keyCode||o.which;8==s&&null!==i&&(a.length>=1?(a.splice(i,1),l.reDraw(e,t,a)):t.clearRect(0,0,e.width,e.height),l.delDraw(e,t,a,null),l.reDraw(e,t,a),l.draw(e,a))}},reDraw:function(e,t,a,i){t.setLineDash([8,0]),t.clearRect(0,0,e.width,e.height);var l=this;a.forEach((function(e,a,o){void 0!==i&&a==i||e.enabled&&(t.beginPath(),t.strokeStyle="blue",t.rect(e.x,e.y,e.w,e.h),t.fillStyle="#f5f5f5",t.fill(),t.stroke(),l.addtext(t,e,a))})),a.forEach((function(e,a,o){e.enabled&&a===i&&(t.beginPath(),t.strokeStyle="red",t.rect(e.x,e.y,e.w,e.h),t.fillStyle="RGBA(102,102,102,0.9)",t.fillRect(e.x,e.y,e.w,e.h),t.stroke(),l.addtext(t,e,a),t.beginPath(),t.strokeStyle="red",t.arc(e.x,e.y,4,0,2*Math.PI),t.fillStyle="red",t.fill(),t.stroke(),t.beginPath(),t.arc(e.x,e.y+e.h,4,0,2*Math.PI),t.fillStyle="red",t.fill(),t.stroke(),t.beginPath(),t.arc(e.x+e.w,e.y+e.h,4,0,2*Math.PI),t.fillStyle="red",t.fill(),t.stroke(),t.beginPath(),t.arc(e.x+e.w,e.y,4,0,2*Math.PI),t.fillStyle="red",t.fill(),t.stroke())}))},changelist:function(e,t){if(t.length>0){for(var a=0;a<t.length;a++)this.$set(this.layers.privacy_zone[a],"x",this.toDecimal(t[a].x/e.width*100)),this.$set(this.layers.privacy_zone[a],"y",this.toDecimal(t[a].y/e.height*100)),this.$set(this.layers.privacy_zone[a],"width",this.toDecimal(t[a].w/e.width*100)),this.$set(this.layers.privacy_zone[a],"height",this.toDecimal(t[a].h/e.height*100));this.$emit("update:layers",this.layers)}},addtext:function(e,t,a){t.w>0&&t.h>0&&(e.font="16pt Arial",e.textAlign="center",e.fillStyle="#4796ff",e.textBaseline="middle",e.strokeStyle="red",e.fillText(t.label+1,t.x+t.w/2,t.y+t.h/2),e.stroke())},toDecimal:function(e){var t=parseFloat(e);if(!isNaN(t))return t=Math.round(100*e)/100,t}}},F=R,B=(a("fd32"),Object(m["a"])(F,X,P,!1,null,"7c970416",null)),I=B.exports,T={components:{Canvasrect:I},directives:{permission:b["a"]},data:function(){return{activeNames:["1"],html_path:"/static/player/index.html",current_select:1,privacy_mask:{privacy_zone:[{enabled:!1,x:0,y:0,width:0,height:0,color:0},{enabled:!1,x:0,y:0,width:0,height:0,color:0},{enabled:!1,x:0,y:0,width:0,height:0,color:0},{enabled:!1,x:0,y:0,width:0,height:0,color:0}]}}},watch:{privacy_mask:{deep:!0,handler:function(e,t){console.log("change")}}},created:function(){this.fetchData()},mounted:function(){this.loadPlayer()},methods:{deletelayer:function(){var e=this.current_select-1,t=this.privacy_mask.privacy_zone[e];this.$set(t,"enabled",!1),this.$set(t,"x",0),this.$set(t,"y",0),this.$set(t,"width",0),this.$set(t,"height",0)},loadPlayer:function(){var e=document.getElementById("wx-player");e.onload=function(){var t=e.contentWindow;sessionStorage.getItem("sub_stream_video_codec");t.postMessage({id:16,stream:1},"*")}},fetchData:function(){var e=this;Object(r["a"])("privacy_mask").then((function(t){e.privacy_mask=t.data.settings,window.console.log(e.privacy_mask)}))},updateData:function(){this.correctionData(),Object(r["b"])({type:"privacy_mask",settings:this.privacy_mask}).then((function(e){window.console.log("updated!")}))},correctionData:function(){for(var e=0;e<this.privacy_mask.privacy_zone.length;e++){var t=this.privacy_mask.privacy_zone[e];t.enabled=t.enabled&&t.width>.01&&t.height>.01}},onSubmit:function(){this.updateData()},onRefresh:function(){this.fetchData(),window.console.log("reload!")},onDefault:function(){var e=this;Object(r["a"])("privacy_mask_default").then((function(t){e.privacy_mask=t.data.settings,window.console.log(e.privacy_mask)}))}}},L=T,W=(a("4104"),Object(m["a"])(L,E,N,!1,null,"a0823c4a",null)),H=W.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"fill_light",staticClass:"custom_form2 auto_wh mt20",attrs:{model:e.fill_light,"label-width":"auto"}},[a("el-col",{attrs:{xl:{span:10,offset:6},lg:{span:12,offset:6},md:{span:16,offset:4},sm:{span:16,offset:4}}},[a("el-form-item",{attrs:{label:e.$t("fill_light.ir_cut")}},[a("el-select",{model:{value:e.fill_light.ir_cut,callback:function(t){e.$set(e.fill_light,"ir_cut",t)},expression:"fill_light.ir_cut"}},e._l(e.ir_cuts,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("fill_light.photosensitive_type")}},[a("el-select",{model:{value:e.fill_light.photosensitive_type,callback:function(t){e.$set(e.fill_light,"photosensitive_type",t)},expression:"fill_light.photosensitive_type"}},e._l(e.photosensitive_types,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.fill_light.photosensitive_type,expression:"fill_light.photosensitive_type"}]},[a("el-form-item",{attrs:{label:e.$t("fill_light.start_sensitivity")}},[a("el-select",{model:{value:e.fill_light.start_sensitivity,callback:function(t){e.$set(e.fill_light,"start_sensitivity",t)},expression:"fill_light.start_sensitivity"}},e._l(e.start_sensitivities,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("fill_light.automatic_sensitivity")}},[a("el-select",{model:{value:e.fill_light.automatic_sensitivity,callback:function(t){e.$set(e.fill_light,"automatic_sensitivity",t)},expression:"fill_light.automatic_sensitivity"}},e._l(e.automatic_sensitivities,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("fill_light.light_type")}},[a("el-select",{model:{value:e.fill_light.light_type,callback:function(t){e.$set(e.fill_light,"light_type",t)},expression:"fill_light.light_type"}},e._l(e.light_types,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("fill_light.dimming_mode")}},[a("el-select",{model:{value:e.fill_light.dimming_mode,callback:function(t){e.$set(e.fill_light,"dimming_mode",t)},expression:"fill_light.dimming_mode"}},e._l(e.dimming_modes,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.fill_light.dimming_mode,expression:"fill_light.dimming_mode"}],attrs:{label:e.$t("fill_light.luminance")}},[a("el-slider",{model:{value:e.fill_light.luminance,callback:function(t){e.$set(e.fill_light,"luminance",t)},expression:"fill_light.luminance"}})],1)],1),a("el-form-item",{attrs:{label:e.$t("fill_light.light_mode")}},[a("el-select",{model:{value:e.fill_light.light_mode,callback:function(t){e.$set(e.fill_light,"light_mode",t)},expression:"fill_light.light_mode"}},e._l(e.light_modes,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("fill_light.image_mode")}},[a("el-select",{model:{value:e.fill_light.image_mode,callback:function(t){e.$set(e.fill_light,"image_mode",t)},expression:"fill_light.image_mode"}},e._l(e.image_modes,(function(t){return a("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3===e.fill_light.image_mode,expression:"fill_light.image_mode===3"}],attrs:{label:e.$t("fill_light.night_start_time")}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss"},model:{value:e.fill_light.night_start_time,callback:function(t){e.$set(e.fill_light,"night_start_time",t)},expression:"fill_light.night_start_time"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3===e.fill_light.image_mode,expression:"fill_light.image_mode===3"}],attrs:{label:e.$t("fill_light.night_end_time")}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss"},model:{value:e.fill_light.night_end_time,callback:function(t){e.$set(e.fill_light,"night_end_time",t)},expression:"fill_light.night_end_time"}})],1),a("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:["admin","operator"],expression:"['admin', 'operator']"}]},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("button.save")))]),a("el-button",{on:{click:e.onRefresh}},[e._v(e._s(e.$t("button.refresh")))]),a("el-button",{attrs:{type:"warning"},on:{click:e.onDefault}},[e._v(e._s(e.$t("button.default")))])],1)],1)],1)},U=[],G=(a("7db0"),{directives:{permission:b["a"]},data:function(){return{fill_light:{ir_cut:0,light_mode:0,light_mode_enum:null,image_mode:0,image_mode_enum:null,night_start_time:null,night_end_time:null,photosensitive_type:0,photosensitive_type_enum:null,start_sensitivity:0,start_sensitivity_enum:null,automatic_sensitivity:0,automatic_sensitivity_enum:null,light_type:0,light_type_enum:null,dimming_mode:0,luminance:0},ir_cuts:[{label:"fill_light.forward",value:0},{label:"fill_light.reverse",value:1}],light_modes:[],image_modes:[],photosensitive_types:[],start_sensitivities:[{label:"fill_light.morning",value:0},{label:"fill_light.middle",value:1},{label:"fill_light.evening",value:2}],automatic_sensitivities:[{label:"fill_light.fast",value:0},{label:"fill_light.middle",value:1},{label:"fill_light.slow",value:2}],light_types:[],dimming_modes:[{label:"fill_light.auto",value:0},{label:"fill_light.manual",value:1}]}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;Object(r["a"])("fill_light").then((function(t){e.fill_light=t.data.settings,window.console.log(e.fill_light),e.updateUi()}))},updateUi:function(){this.light_modes=this.fetchLightModeOptions(this.fill_light.light_mode_enum),this.image_modes=this.fetchImageModeOptions(this.fill_light.image_mode_enum),this.photosensitive_types=this.fetchPhotoSensitiveOptins(this.fill_light.photosensitive_type_enum),this.light_types=this.fetchLightTypeOptins(this.fill_light.light_type_enum)},updateData:function(){Object(r["b"])({type:"fill_light",settings:this.fill_light}).then((function(e){window.console.log("updated!")}))},extractOptions:function(e,t){for(var a=[],i=function(i){var l=e.find((function(e){return e.value===t[i]}));l&&a.push(l)},l=0;l<t.length;l++)i(l);return a},onSubmit:function(){this.updateData()},onRefresh:function(){this.fetchData(),window.console.log("reload!")},onDefault:function(){var e=this;Object(r["a"])("fill_light_default").then((function(t){e.fill_light=t.data.settings,window.console.log(e.fill_light),e.updateUi()}))},fetchLightModeOptions:function(e){var t=[{label:"fill_light.lampred",value:0},{label:"fill_light.lampwhite",value:1},{label:"fill_light.lampdouble",value:2},{label:"fill_light.smart_lampred",value:16},{label:"fill_light.smart_lampwhite",value:17},{label:"fill_light.smart_lampdouble",value:18}];return this.extractOptions(t,e)},fetchImageModeOptions:function(e){var t=[{label:"fill_light.auto",value:0},{label:"fill_light.day",value:1},{label:"fill_light.night",value:2},{label:"fill_light.timing",value:3}];return this.extractOptions(t,e)},fetchPhotoSensitiveOptins:function(e){var t=[{label:"fill_light.hard",value:0},{label:"fill_light.soft",value:1}];return this.extractOptions(t,e)},fetchLightTypeOptins:function(e){var t=[{label:"fill_light.red_light",value:0},{label:"fill_light.warm_light",value:1}];return this.extractOptions(t,e)}}}),V=G,Z=(a("6c87"),Object(m["a"])(V,J,U,!1,null,"1406d726",null)),q=Z.exports,K={components:{videoCapture:w,videoCodec:f,osd:A,filllight:q,privacyMask:H},data:function(){return{activeName:"first",pages:{first:{istab:!0,key:"first"},second:{istab:!1,key:"second"},third:{istab:!1,key:"third"},fourth:{istab:!1,key:"fourth"},fifth:{istab:!1,key:"fifth"},sixth:{istab:!1,key:"sixth"},seventh:{istab:!1,key:"seventh"}}}},created:function(){},mounted:function(){},methods:{handleClick:function(e){for(var t in this.pages)e.name!=t?this.pages[t]["istab"]=!1:this.pages[t]["istab"]=!0}}},Q=K,ee=(a("144d"),Object(m["a"])(Q,i,l,!1,null,"508508ae",null));t["default"]=ee.exports},b2f1:function(e,t,a){"use strict";a("44bb")},cb29:function(e,t,a){var i=a("23e7"),l=a("81d5"),o=a("44d2");i({target:"Array",proto:!0},{fill:l}),o("fill")},e350:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a("d3b7"),a("caad"),a("2532");var i=a("4360");function l(e){if(e&&e instanceof Array&&e.length>0){var t=i["a"].getters&&i["a"].getters.roles,a=e,l=t.some((function(e){return a.includes(e)}));return l}return console.error("need roles! Like v-permission=\"['admin','editor']\""),!1}},e9c4:function(e,t,a){var i=a("23e7"),l=a("d066"),o=a("d039"),s=l("JSON","stringify"),n=/[\uD800-\uDFFF]/g,r=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,d=function(e,t,a){var i=a.charAt(t-1),l=a.charAt(t+1);return r.test(e)&&!c.test(l)||c.test(e)&&!r.test(i)?"\\u"+e.charCodeAt(0).toString(16):e},u=o((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&i({target:"JSON",stat:!0,forced:u},{stringify:function(e,t,a){var i=s.apply(null,arguments);return"string"==typeof i?i.replace(n,d):i}})},fbdf:function(e,t,a){"use strict";a("2b9c")},fd32:function(e,t,a){"use strict";a("85f0")}}]);